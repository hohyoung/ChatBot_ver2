# 1. 시스템 아키텍처

## 1.1 전체 구조

```
┌─────────────────────────────────────────────────────────────┐
│                      Client (Browser)                        │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐       │
│  │  QueryPage   │  │  UploadPage  │  │  AdminPage   │       │
│  └──────────────┘  └──────────────┘  └──────────────┘       │
│         │ WebSocket      │ HTTP           │ HTTP             │
└─────────┼────────────────┼────────────────┼──────────────────┘
          │                │                │
          ▼                ▼                ▼
┌─────────────────────────────────────────────────────────────┐
│                   Vite Dev Server (Proxy)                    │
│                    :5173 → :8000                             │
└─────────────────────────────────────────────────────────────┘
          │
          ▼
┌─────────────────────────────────────────────────────────────┐
│                  FastAPI Backend (:8000)                     │
│  ┌──────────────────────────────────────────────────────┐   │
│  │              Router Layer                             │   │
│  │  /api/chat/  /api/docs/  /api/auth/  /api/admin/     │   │
│  └──────────────────────────────────────────────────────┘   │
│  ┌──────────────────────────────────────────────────────┐   │
│  │              Service Layer                            │   │
│  │  ┌──────────────┐  ┌──────────────┐  ┌────────────┐ │   │
│  │  │ Orchestrator │  │   Pipeline   │  │  Security  │ │   │
│  │  └──────────────┘  └──────────────┘  └────────────┘ │   │
│  │  ┌──────────────┐  ┌──────────────┐  ┌────────────┐ │   │
│  │  │   Retriever  │  │  Generator   │  │  Embedding │ │   │
│  │  └──────────────┘  └──────────────┘  └────────────┘ │   │
│  └──────────────────────────────────────────────────────┘   │
│  ┌──────────────────────────────────────────────────────┐   │
│  │              Data Layer                               │   │
│  │  ┌──────────────┐  ┌──────────────┐  ┌────────────┐ │   │
│  │  │  VectorStore │  │   UserDB     │  │  Storage   │ │   │
│  │  │  (ChromaDB)  │  │ (SQLite/SQL) │  │  (Files)   │ │   │
│  │  └──────────────┘  └──────────────┘  └────────────┘ │   │
│  └──────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────┘
          │                │                │
          ▼                ▼                ▼
┌─────────────────────────────────────────────────────────────┐
│                   External Services                          │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐       │
│  │  OpenAI API  │  │    Redis     │  │   S3/Blob    │       │
│  │  (GPT-4o)    │  │   (Cache)    │  │  (Storage)   │       │
│  └──────────────┘  └──────────────┘  └──────────────┘       │
└─────────────────────────────────────────────────────────────┘
```

---

## 1.2 기술 스택

### 백엔드
- **프레임워크:** FastAPI 0.110+
- **언어:** Python 3.11+
- **ORM:** SQLAlchemy 2.0
- **벡터 DB:** ChromaDB 0.4+
- **관계형 DB:** SQLite (개발) / MSSQL (프로덕션)
- **캐싱:** Redis (OTP, FAQ, 검색 결과)
- **작업 큐:** asyncio Queue
- **이미지 처리:** PyMuPDF (fitz), Pillow
- **클러스터링:** scikit-learn (DBSCAN)
- **이메일:** smtplib (Gmail SMTP)

### 프론트엔드
- **프레임워크:** React 19.1+
- **빌드 도구:** Vite 7.1+
- **라우팅:** React Router 7.8+
- **상태 관리:** 로컬 상태 (Context API)
- **스타일:** CSS Modules
- **마크다운:** react-markdown, remark-gfm
- **XSS 방지:** DOMPurify

### 인프라
- **웹 서버:** Uvicorn
- **프록시:** Nginx (프로덕션)
- **컨테이너:** Docker + Docker Compose
- **CI/CD:** GitHub Actions

---

## 1.3 레이어별 책임

### Router Layer
- HTTP/WebSocket 요청 처리
- 요청 검증 (Pydantic)
- 인증/권한 확인
- 응답 직렬화

### Service Layer
- 비즈니스 로직 구현
- 외부 API 호출 (OpenAI)
- 데이터 가공 및 변환
- 캐싱 관리

### Data Layer
- 데이터베이스 CRUD
- 파일 시스템 I/O
- 벡터 저장소 관리
